#!/bin/sh
# This script returns an icon and network variable
disconnect=""
ethernet=""
wifi=""

get_networkmanager(){
	connected=$(nmcli device | grep -w "connected" -m1)
	if [ -n "$connected" ]; then
		icon=$(printf '%s' "$connected" | awk -F' ' '{print $2}' | sed "s/wifi/${wifi}/; s/ethernet/${ethernet}/")
		network=$(printf '%s' "$connected" | awk -F' ' '{print $4}')
	else
		icon="$disconnect"
		network="No Internet"
	fi
}


get_connman(){
	connected=$(connmanctl services | grep -E "^\*")
	if [ -n "$connected" ]; then
		type_name=$(printf '%s' "$connected" | awk -F'_| *' '(NR==1){print $3,$2}' | sed "s/wifi/${wifi}/; s/ethernet/${ethernet}/")
		icon="$(printf '%s' "$type_name" | cut -d' ' -f1)"
		network="$(printf '%s' "$type_name" | cut -d' ' -f2- <<< "$type_name")"
	else
		icon="$disconnect"
		network="No Internet"
	fi
}


main() {
	if command -v NetworkManager >/dev/null && pidof NetworkManager >/dev/null; then
		get_networkmanager
	elif command -v connmand >/dev/null && pidof connmand >/dev/null; then
		get_connman
	else
		icon="$disconnect"
		network="No Network Manager"
	fi
}
main
