#!/bin/sh
if [ "$1" == "-t" ]; then
	dir="/tmp/TmpScreenshots/"
	tmpmsg="in /tmp/TmpScreenshots"
	shift
else
	dir="$HOME/Pictures/Screenshots"
	tmpmsg=""
fi

checkDir(){
	[ ! -d "$dir" ] && mkdir --parents "$dir"
}


CMD=$(echo -e "Full Screenshot\nPartial Screenshot\nCancel" | dmenu "$@" | cut -d' ' -f1);
Current_Date=$(date '+%Y_%m_%d-(%H:%M:%S)')

path="$dir/Screenshot_${Current_Date}.png"
string="Took Screenshot Screenshot_${Current_Date}.png ${tmpmsg}"


scrot_screenshot(){
	case $CMD in
		Full)
			checkDir
			scrot -d 0.5 "$path" &&
			herbe "$string"
			;;

		Partial)
			checkDir
			scrot -s -d 0.5 "$path" &&
			herbe "$string"
			;;

		*) herbe "Did not take screenshot";
	esac
}

imagemagick_screenshot(){
	case $CMD in
		Full)
			checkDir
			sleep 0.5 && magick import -window root "$path" &&
			herbe "$string"
			;;

		Partial)
			checkDir
			sleep 0.5 && magick import "$path" &&
			herbe "$string"
			;;
		*) herbe "Did not take screenshot";
	esac
}


if command -v scrot; then
    scrot_screenshot
elif command -v magick; then
    imagemagick_screenshot
else
    herbe "You do not have either scrot or imagemagick installed"
fi
