#!/bin/sh
error() {
	if command -v herbe >/dev/null; then
		herbe "$1"
	else
		echo "$1"
	fi
}

if ! command -v dmenu >/dev/null; then
	error "Dmenu is not installed"
	exit 1
fi


if [ ! -d $HOME/Documents ]; then
	error "$HOME/Documents does not exist"
	exit 1
fi


cd $HOME
Documents="$(find Documents -type f)"
chosen=$(echo "$Documents" | dmenu -i $@)

if [ ! -f "$chosen" ]; then
	if command -v herbe >/dev/null; then
		herbe 'Did not pick a file'
	else
		printf 'Did not pick a file\n'
	fi

	exit
fi

mime_type=$(file --mime-type --brief "$chosen")
case $mime_type in
	*/pdf)
		if ! command -v zathura >/dev/null ; then
			error "zathura is not installed"
			exit 1
		fi
		zathura "$chosen"
		;;

	image/*)
		if ! command -v sxiv >/dev/null ; then
			error "sxiv is not installed"
			exit 1
		fi
		sxiv "$chosen"
		;;

	video/*)
		if ! command -v ffplay >/dev/null ; then
			error "ffplay is not installed"
			exit 1
		fi
		ffplay "$chosen"
		;;

	*)
		$TERMINAl -e $EDITOR "$chosen"
		;;
esac
